(function(t){function e(e){for(var r,i,l=e[0],c=e[1],s=e[2],f=0,p=[];f<l.length;f++)i=l[f],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&p.push(n[i][0]),n[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(p.length)p.shift()();return o.push.apply(o,s||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],r=!0,l=1;l<a.length;l++){var c=a[l];0!==n[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=a[0]))}return t}var r={},n={app:0},o=[];function i(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=r,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(a,r,function(e){return t[e]}.bind(null,r));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var s=0;s<l.length;s++)e(l[s]);var u=c;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0fda":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var r,n,o=a("2b0e"),i=a("5c96"),l=a.n(i),c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-container"},[e("input",{ref:"upload",staticStyle:{display:"none"},attrs:{type:"file",accept:".xls,.xlsx,.csv"},on:{change:t.submitFile}}),e("input",{ref:"uploadName",staticStyle:{display:"none"},attrs:{type:"file",accept:".xls,.xlsx,.csv"},on:{change:t.submitFileName}}),e("div",{staticClass:"base-data-box"},[e("el-button",{staticClass:"upload-base",attrs:{type:"primary"},on:{click:t.open}},[t._v("上传要素")]),e("el-tabs",{staticStyle:{width:"100%",height:"100%"},attrs:{"tab-position":"left",type:"border-card"}},t._l(t.sheetName,(function(a,r){return e("el-tab-pane",{key:r,attrs:{name:"".concat(r),label:a.label}},[e("v-table",{attrs:{data:a.tableData,stripe:"","max-height":"calc(100vh - 30px)"}},[e("el-table-column",{attrs:{type:"index",width:60,label:"序号"}}),t._l(a.columns,(function(t,r){return e("el-table-column",{key:"".concat(a).concat(r),attrs:{prop:t.prop,label:t.label}})}))],2)],1)})),1)],1),e("div",{staticClass:"content"},[e("div",{staticClass:"content-form"},[e("el-button",{staticStyle:{"margin-right":"16px"},attrs:{type:"primary"},on:{click:t.openName}},[t._v("导入样品名称\n      ")]),e("el-form",{ref:"searchForm",staticStyle:{flex:"1",width:"0"},attrs:{model:t.form}},[e("el-row",{attrs:{gutter:16}},[e("el-col",t._b({},"el-col",t.col,!1),[e("el-form-item",{attrs:{"label-width":"100px",label:"编号前缀：",prop:"title"}},[e("el-input",{attrs:{placeholder:"请输入编号前缀"},model:{value:t.form.prefix,callback:function(e){t.$set(t.form,"prefix","string"===typeof e?e.trim():e)},expression:"form.prefix"}})],1)],1),e("el-col",t._b({},"el-col",t.col,!1),[e("el-form-item",{attrs:{"label-width":"100px",label:"补充序列：",prop:"title"}},[e("el-input",{attrs:{placeholder:"请输入补充序列"},model:{value:t.form.suffix,callback:function(e){t.$set(t.form,"suffix","string"===typeof e?e.trim():e)},expression:"form.suffix"}})],1)],1),e("el-col",t._b({},"el-col",t.col,!1),[e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onCreateCode}},[t._v("生成编号")]),e("el-button",{on:{click:t.exportExcel}},[t._v("导出")])],1)],1)],1)],1)],1),e("v-table",{attrs:{data:t.tableData,stripe:"","max-height":"calc(100vh - 30px)"}},[e("el-table-column",{attrs:{type:"index",width:60,label:"序号"}}),t._l(t.columns,(function(t,a){return e("el-table-column",{key:"code".concat(a),attrs:{prop:t.prop,label:t.label}})}))],2)],1)])},s=[],u=(a("8e6e"),a("ac6a"),a("456d"),a("34ef"),a("c5f6"),a("ade3")),f=(a("7514"),a("28a5"),a("25ca")),p=(a("6762"),a("2fdb"),a("4917"),a("b1f8"),a("c152")),h={name:"VTable",extends:i["Table"],computed:{bodyHeight:function(){var t=this.layout,e=t.headerHeight,a=void 0===e?0:e,r=t.bodyHeight,n=t.footerHeight,o=void 0===n?0:n;if(this.height)return{height:r?"".concat(r,"px"):""};if(this.maxHeight){var i=Object(p["a"])(this.maxHeight);if("number"===typeof i)return{"max-height":"".concat(i-o-(this.showHeader?a:0),"px")};if(i.match(/\d+%/g))return{"max-height":"calc(".concat(i," - ").concat(o+this.showHeader?a:0,"px)")};if(i.includes("calc"))return{"max-height":"".concat(i.slice(0,-1)," - ").concat(o+this.showHeader?a:0,"px)")}}return{}},fixedBodyHeight:function(){if(this.height)return{height:this.layout.fixedBodyHeight?"".concat(this.layout.fixedBodyHeight,"px"):""};if(this.maxHeight){var t=Object(p["a"])(this.maxHeight);if("number"===typeof t)return t=this.layout.scrollX?t-this.layout.gutterWidth:t,this.showHeader&&(t-=this.layout.headerHeight),t-=this.layout.footerHeight,{"max-height":"".concat(t,"px")};if(t.match(/\d+%/g)){var e=0;return this.layout.scrollX&&(e+=this.layout.gutterWidth),this.showHeader&&(e+=this.layout.headerHeight),e+=this.layout.footerHeight,{"max-height":"calc(".concat(t," - ").concat(e,"px)")}}if(t.includes("calc")){var a=0;return this.layout.scrollX&&(a+=this.layout.gutterWidth),this.showHeader&&(a+=this.layout.headerHeight),a+=this.layout.footerHeight,{"max-height":"".concat(t.slice(0,-1)," - ").concat(a,"px)")}}}return{}}}},d=h,b=a("2877"),m=Object(b["a"])(d,r,n,!1,null,null,null),y=m.exports;function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function x(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){Object(u["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var v={name:"App",props:{},components:{VTable:y},data:function(){return{wb:null,wbname:null,factorData:[],sheetName:[],tableData:[],columns:[{prop:"名称",label:"名称"},{prop:"编号",label:"编号"}],col:{xs:8,sm:8,md:8,lg:8,xl:8},labelCol:{xxl:5,xl:8,lg:10,md:10,sm:10,xs:10},wrapperCol:{xxl:19,xl:16,lg:14,md:14,sm:14,xs:14},btnWrapperCol:{xxl:{span:24},xl:{span:24},lg:{span:24},md:{span:24},sm:{span:24},xs:{span:24}},form:{prefix:"",suffix:""}}},created:function(){},mounted:function(){},computed:{},methods:{open:function(){var t=this.$refs.upload;t&&t.click()},openName:function(){var t=this.$refs.uploadName;t&&t.click()},onCreateCode:function(){var t=this;t.tableData.length>0&&t.sheetName.length>0?t.tableData=t.tableData.map((function(e,a){var r=e["名称"].split("-"),n=r.map((function(e,a){var r=t.sheetName[a].tableData.find((function(t){return"".concat(t["名称"])==="".concat(e)}));return r?r["编号"]:""}));return x(x({},e),{},{"编号":"".concat(t.form.prefix).concat(n.join("")).concat(t.form.suffix?"".concat(Number(1+t.form.suffix)+a).substring(1):"")})})):0===t.sheetName.length?this.$alert("请先上传要素文件","提示",{type:"warning"}):this.$alert("请上传样品名称文件","提示",{type:"warning"})},submitFile:function(t){if(t.currentTarget.files.length){var e=this,a=t.currentTarget.files[0],r=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var a="";r.onload=function(){for(var t=new Uint8Array(r.result),n=t.byteLength,o=0;o<n;o++)a+=String.fromCharCode(t[o]);e.wb=Object(f["a"])(a,{type:"binary"}),e.onChangeSheet()},r.readAsArrayBuffer(t)},r.readAsBinaryString(a)}},onChangeSheet:function(){var t=this;t.sheetName=t.wb.SheetNames.map((function(e){var a=f["b"].sheet_to_json(t.wb.Sheets[e]);return{label:e,tableData:a,columns:Object.keys(a[0]).map((function(t){return{label:t,prop:t}}))}}))},submitFileName:function(t){if(t.currentTarget.files.length){var e=this,a=t.currentTarget.files[0],r=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var a="";r.onload=function(){for(var t=new Uint8Array(r.result),n=t.byteLength,o=0;o<n;o++)a+=String.fromCharCode(t[o]);e.wbname=Object(f["a"])(a,{type:"binary"}),e.tableData=f["b"].sheet_to_json(e.wbname.Sheets[e.wbname.SheetNames[0]])},r.readAsArrayBuffer(t)},r.readAsBinaryString(a)}},exportExcel:function(){var t=this,e="".concat(t.columns.map((function(t){return t.label})).join(","),"\n");e+=t.tableData.map((function(e){return t.columns.map((function(t){return e[t.prop]})).join("\t,")})).join("\n");var a="data:text/csv;charset=utf-8,\ufeff".concat(encodeURIComponent(e)),r=document.createElement("a");r.href=a,r.download="样品.csv",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}},w=v,O=(a("c2c7"),Object(b["a"])(w,c,s,!1,null,"6538bf5a",null)),j=O.exports;a("db4d"),a("0fae"),a("5a8b"),a("7e79");o["default"].config.productionTip=!1,o["default"].use(l.a,{size:"small"}),new o["default"]({render:function(t){return t(j)}}).$mount("#app")},"5a8b":function(t,e,a){},"7e79":function(t,e,a){},c2c7:function(t,e,a){"use strict";a("0fda")}});